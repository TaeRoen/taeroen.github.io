<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>TaeRoen&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://taeroen.github.io/"/>
  <updated>2018-09-19T06:58:23.919Z</updated>
  <id>https://taeroen.github.io/</id>
  
  <author>
    <name>TaeRoen</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用docker搭建gitlab服务</title>
    <link href="https://taeroen.github.io/post/2017-03-06-%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAgitlab%E6%9C%8D%E5%8A%A1.html"/>
    <id>https://taeroen.github.io/post/2017-03-06-使用docker搭建gitlab服务.html</id>
    <published>2017-03-06T14:18:48.000Z</published>
    <updated>2018-09-19T06:58:23.919Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Quick-start"><a href="#Quick-start" class="headerlink" title="Quick start"></a>Quick start</h2><p>这是官方文档中的运行命令</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo docker run --detach \</div><div class="line">    --hostname gitlab.example.com \</div><div class="line">    --publish 443:443 --publish 80:80 --publish 22:22 \</div><div class="line">    --name gitlab \</div><div class="line">    --restart always \</div><div class="line">    --volume /srv/gitlab/config:/etc/gitlab:Z \</div><div class="line">    --volume /srv/gitlab/logs:/var/<span class="built_in">log</span>/gitlab:Z \</div><div class="line">    --volume /srv/gitlab/data:/var/opt/gitlab:Z \</div><div class="line">    gitlab/gitlab-ce:latest</div></pre></td></tr></table></figure><p></p><p>这是我自己搭建时使用的命令</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo docker run --detach \</div><div class="line">    --hostname git.taeroen.xyz \</div><div class="line">    --publish 1443:443 --publish 1080:80 --publish 1022:22 \</div><div class="line">    --name gitlab-ce \</div><div class="line">    --restart unless-stopped \</div><div class="line">    --volume /data/gitlab/config:/etc/gitlab:Z \</div><div class="line">    --volume /data/gitlab/logs:/var/<span class="built_in">log</span>/gitlab:Z \</div><div class="line">    --volume /data/gitlab/data:/var/opt/gitlab:Z \</div><div class="line">    gitlab/gitlab-ce:8.17.2-ce.0</div></pre></td></tr></table></figure><p></p><p>两者区别的地方就是可以自定义配置的地方，hostname只是个实例，如果有域名的话可以配成自己的，也可以更改自己的hosts来指向；端口的话随意，内部端口正确即可以；restart策略我更习惯使用unless-stopped，如果我手动stop后不会在下一次开机后重启；挂载目录的话可以看自己的需求，我习惯都挂载/data目录下；最后的tag建议改成一个固定值，实际上就是latest指向的值，这样避免升级时由于版本问题带来可能的bug。</p><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><p>实际使用时需要在启动时传一些额外的参数，例如lfs，external_url，可以在启动时添加额外的参数。</p><p>例如:</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GITLAB_OMNIBUS_CONFIG=<span class="string">"external_url 'https://git.taeroen.xyz:1443/';  gitlab_rails['lfs_enabled'] = true; nginx['redirect_http_to_https'] = true; nginx['ssl_certificate'] = '/etc/letsencrypt/live/git.taeroen.xyz/fullchain.pem';</span></div><div class="line">nginx['ssl_certificate_key'] = '/etc/letsencrypt/live/git.taeroen.xyz/privkey.pem';</div></pre></td></tr></table></figure><p></p><h2 id="配置Let’s-Encrypt"><a href="#配置Let’s-Encrypt" class="headerlink" title="配置Let’s Encrypt"></a>配置Let’s Encrypt</h2><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/letsencrypt/letsencrypt</div><div class="line"><span class="built_in">cd</span> letsencrypt</div><div class="line">./letsencrypt-auto --agree-tos --email taeroen@gmail.com certonly --webroot -w /usr/share/nginx/html/ <span class="_">-d</span> git.taeroen.xyz</div></pre></td></tr></table></figure><p></p><h2 id="最终配置"><a href="#最终配置" class="headerlink" title="最终配置"></a>最终配置</h2><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">sudo docker run --detach \</div><div class="line">    --hostname git.taeroen.xyz \</div><div class="line">    --publish 443:443 --publish 80:80 --publish 22:22 \</div><div class="line">    --name gitlab-ce \</div><div class="line">    --restart unless-stopped \</div><div class="line">    --volume /data/gitlab/config:/etc/gitlab:Z \</div><div class="line">    --volume /data/gitlab/logs:/var/<span class="built_in">log</span>/gitlab:Z \</div><div class="line">    --volume /data/gitlab/data:/var/opt/gitlab:Z \</div><div class="line">    --volume /data/git.taeroen.xyz/fullchain.pem:/etc/gitlab/ssl/git.taeroen.xyz.crt \</div><div class="line">    --volume /data/git.taeroen.xyz/privkey.pem:/etc/gitlab/ssl/git.taeroen.xyz.key \</div><div class="line">    --env GITLAB_OMNIBUS_CONFIG=<span class="string">"external_url 'https://git.taeroen.xyz/';gitlab_rails['lfs_enabled'] = true;"</span> \</div><div class="line">    gitlab/gitlab-ce:8.17.2-ce.0</div></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Quick-start&quot;&gt;&lt;a href=&quot;#Quick-start&quot; class=&quot;headerlink&quot; title=&quot;Quick start&quot;&gt;&lt;/a&gt;Quick start&lt;/h2&gt;&lt;p&gt;这是官方文档中的运行命令&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p class=&quot;
      
    
    </summary>
    
    
      <category term="docker" scheme="https://taeroen.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Linux下常见压缩文件的相关操作</title>
    <link href="https://taeroen.github.io/post/2017-03-06-Linux%E4%B8%8B%E5%B8%B8%E8%A7%81%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C.html"/>
    <id>https://taeroen.github.io/post/2017-03-06-Linux下常见压缩文件的相关操作.html</id>
    <published>2017-03-06T06:11:45.000Z</published>
    <updated>2018-09-19T06:58:06.004Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Linux下常见压缩文件的相关操作"><a href="#Linux下常见压缩文件的相关操作" class="headerlink" title="Linux下常见压缩文件的相关操作"></a>Linux下常见压缩文件的相关操作</h1><p>Linux常见的打包及压缩文件格式有tar,tar.gz,tar.xz,tar.bz2,zip,虽然命令不多，但是经常容器弄混，在这里用表格整理一下，方便记忆及操作。</p><ul><li>源文件:src.xxx</li><li>目标文件:dest.xxx</li><li>解压到指定目录:/tmp</li></ul><table><thead><tr><th>扩展文件名</th><th>解压缩</th><th>解压缩到指定目录</th><th>压缩</th><th>可选参数</th></tr></thead><tbody><tr><td>zip</td><td>unzip src.zip</td><td></td><td>unzip src.zip dest</td><td></td></tr><tr><td>gz</td><td>gnuzip src.gz</td><td></td><td>gzip src</td><td></td></tr><tr><td>tar</td><td>tar xf src.tar</td><td>tar xf src.tar -C /tmp</td><td>tar cf dest.tar src</td><td>-v 显示过程</td></tr><tr><td>tar.gz/tgz</td><td>tar zxf src.tar.gz</td><td>tar zxf dest.tar.gz -C /tmp</td><td>tar zcf dest.tar.gz src</td><td>-v 显示过程</td></tr><tr><td>tar.bz2</td><td>tar jxf src.tar.bz2</td><td>tar jxf dest.tar.bz2 -C /tmp</td><td>tar jcf dest.tar.bz2 src</td><td>-v 显示过程</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Linux下常见压缩文件的相关操作&quot;&gt;&lt;a href=&quot;#Linux下常见压缩文件的相关操作&quot; class=&quot;headerlink&quot; title=&quot;Linux下常见压缩文件的相关操作&quot;&gt;&lt;/a&gt;Linux下常见压缩文件的相关操作&lt;/h1&gt;&lt;p&gt;Linux常见的打包
      
    
    </summary>
    
    
      <category term="linux" scheme="https://taeroen.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Debian8 内核编译</title>
    <link href="https://taeroen.github.io/post/2016-12-17-Debian8-%E5%86%85%E6%A0%B8%E7%BC%96%E8%AF%91.html"/>
    <id>https://taeroen.github.io/post/2016-12-17-Debian8-内核编译.html</id>
    <published>2016-12-17T05:30:48.000Z</published>
    <updated>2018-09-19T06:57:48.671Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Debian8-内核编译"><a href="#Debian8-内核编译" class="headerlink" title="Debian8 内核编译"></a>Debian8 内核编译</h1><p>本文介绍两种编译linux内核的方式，一种是debian发行版打过补丁和更改过配置的内核，一种是linux的原版内核。</p><h2 id="1-准备编译环境"><a href="#1-准备编译环境" class="headerlink" title="1 准备编译环境"></a>1 准备编译环境</h2><p>安装编译工具链</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># apt-get install build-essential kernel-package libncurses5-dev -y</span></div></pre></td></tr></table></figure><p></p><h2 id="2-下载Debian发行版内核源码"><a href="#2-下载Debian发行版内核源码" class="headerlink" title="2 下载Debian发行版内核源码"></a>2 下载Debian发行版内核源码</h2><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># apt-get install linux-source-3.16 -y</span></div></pre></td></tr></table></figure><p></p><p>内核源码包安装完成后下载到/user/src目录下</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ls /usr/src -al | grep linux-source-3.16</div><div class="line">rw-r--r-- 1 root root 81957884 - - - linux-source-3.16.tar.xz</div></pre></td></tr></table></figure><p></p><p>解压源码包</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mkdir -p ~/build/kernel</div><div class="line">$ <span class="built_in">cd</span> ~/build/kernel</div><div class="line">$ tar -Jxvf /user/src/linux-source-3.16.tar.xz</div></pre></td></tr></table></figure><p></p><h2 id="3-内核编译"><a href="#3-内核编译" class="headerlink" title="3 内核编译"></a>3 内核编译</h2><p>按需求更改配置,如果不想更改配置，直接双击ESC保存.config退出即可</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ make menuconfig</div></pre></td></tr></table></figure><p></p><p>编译内核</p><p></p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ make deb-pjg</div></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Debian8-内核编译&quot;&gt;&lt;a href=&quot;#Debian8-内核编译&quot; class=&quot;headerlink&quot; title=&quot;Debian8 内核编译&quot;&gt;&lt;/a&gt;Debian8 内核编译&lt;/h1&gt;&lt;p&gt;本文介绍两种编译linux内核的方式，一种是debian发行
      
    
    </summary>
    
    
      <category term="linux" scheme="https://taeroen.github.io/tags/linux/"/>
    
  </entry>
  
</feed>
